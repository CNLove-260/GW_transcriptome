{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red255\green255\blue255;\red129\green95\blue3;
\red0\green0\blue0;}
{\*\expandedcolortbl;;\csgenericrgb\c0\c0\c0\c85000;\csgenericrgb\c100000\c100000\c100000;\csgenericrgb\c50580\c37140\c1210;
\csgenericrgb\c0\c0\c0\c70000;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab593
\pard\tx593\pardeftab593\pardirnatural\partightenfactor0

\f0\fs36 \cf2 \cb3 Bioinformatic synopsis, Love et al.
\fs24 \

\fs36 \cf4 ==========
\fs24 \cf2 \
\

\fs30 RNA-seq: Trimmomatic
\fs24 \

\fs30 \cf4 ---------
\fs24 \cf2 \
\
\cf5 ```sh\cf2 \
\cf5 trimmomatic \\\cf2 \
\cf5     PE -threads 1 -phred33 \\\cf2 \
\cf5     -summary $OUT_FASTQ1.sum \\\cf2 \
\cf5     $IN_FASTQ1 $IN_FASTQ22 \\\cf2 \
\cf5     $OUT_FASTQ1 $OUT_UNPAIRED1 \\\cf2 \
\cf5     $OUT_FASTQ2 $OUT_UNPAIRED2 \\\cf2 \
\cf5     LEADING:20 TRAILING:20 SLIDINGWINDOW:5:20 MINLEN:$EIGHTY_PERCENT_READLENGTH\cf2 \
\cf5 ```\cf2 \
\

\fs30 RNA-seq: STAR
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\
\cf5 ```sh\cf2 \
\cf5 STAR \\\cf2 \
\cf5     --genomeDir $INDEX_DIR \\\cf2 \
\cf5     --readFilesIn $FASTQ1 $FASTQ2 \\\cf2 \
\cf5     --readFilesCommand zcat \\\cf2 \
\cf5     --outFileNamePrefix ./ \\\cf2 \
\cf5     --outSAMtype None \\\cf2 \
\cf5     --outSJfilterCountTotalMin 10 5 5 5 --outSJfilterCountUniqueMin 10 5 5 5\cf2 \
\
\cf5 STAR \\\cf2 \
\cf5     --genomeDir $FIRSTPASS_INDEX_DIR \\\cf2 \
\cf5     --readFilesIn $FASTQ1 $FASTQ2 \\\cf2 \
\cf5     --readFilesCommand zcat \\\cf2 \
\cf5     --outFileNamePrefix ./ \\\cf2 \
\cf5     --outSAMtype BAM SortedByCoordinate \\\cf2 \
\cf5     --outFilterMultimapNmax 1 --outFilterMismatchNmax $TEN_PERCENT_PAIRLENGTH\cf2 \
\cf5 ```\cf2 \
\

\fs30 RNA-seq: HTSeq
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\
\cf5 ```sh\cf2 \
\cf5 htseq-counts \\\cf2 \
\cf5     --stranded=no --idattr=gene_id --type=exon --mode=union \\\cf2 \
\cf5     --format=bam \\\cf2 \
\cf5     $BAM \\\cf2 \
\cf5     $ENSEMBL98_GTF \\\cf2 \
\cf5     > $COUNTS_TSV\cf2 \
\cf5 ```\cf2 \
\

\fs30 RNA-seq: GEDIT
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\
\cf5 ```sh\cf2 \
\cf5 python2 ./scripts/GEDIT.py -mix ./my_CPMs.tsv -ref ./ReferenceMatrices/Mouse/TabulaMurisReference.csv -out ./out.txt\cf2 \
\cf5 Rscript ./scripts/GLM_Decon.R \\\cf2 \
\cf5     ./scripts/scratch/my_CPMs.tsv_TabulaMurisReference.csv_50_Entropy_0.0_ScaledMix.tsv \\\cf2 \
\cf5     ./scripts/scratch/my_CPMs.tsv_TabulaMurisReference.csv_50_Entropy_0.0_ScaledRef.tsv \\\cf2 \
\cf5     ./predictions/my_CPMs.tsv_TabulaMurisReference.csv_50_Entropy_0.0Predictions.tsv\cf2 \
\cf5 ```\cf2 \
\

\fs30 RNA-seq: GATK
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\
\cf5 ```sh\cf2 \
\cf5 gatk \\\cf2 \
\cf5     AddOrReplaceReadGroups \\\cf2 \
\cf5     -I $BAM -O ./rg.bam \\\cf2 \
\cf5     --RGID=$NAME --RGSM=$NAME --RGLB=$NAME --RGPL=Illumina \\\cf2 \
\cf5     --RGPU=$LANE_ID\cf2 \
\
\cf5 gatk \\\cf2 \
\cf5     MarkDuplicates \\\cf2 \
\cf5     --INPUT ./rg.bam \\\cf2 \
\cf5     --OUTPUT ./rg-mdups.bam \\\cf2 \
\cf5     --CREATE_INDEX true \\\cf2 \
\cf5     --VALIDATION_STRINGENCY SILENT \\\cf2 \
\cf5     --METRICS_FILE ./mdups.metrics \\\cf2 \
\
\cf5 gatk \\\cf2 \
\cf5     SplitNCigarReads \\\cf2 \
\cf5     --reference $GENOME_FASTA \\\cf2 \
\cf5     --input ./rg-mdups.bam \\\cf2 \
\cf5     --output ./rg-mdups-sncr.bam \\\cf2 \
\
\cf5 gatk \\\cf2 \
\cf5     HaplotypeCaller \\\cf2 \
\cf5     --reference $GENOME_FASTA \\\cf2 \
\cf5     --input ./rg-mdups-sncr.bam \\\cf2 \
\cf5     --output $GVCF \\\cf2 \
\cf5     --emit-ref-confidence GVCF \\\cf2 \
\cf5     --dont-use-soft-clipped-bases\cf2 \
\cf5 ```\cf2 \
\
Then,\
\
\cf5 ```sh\cf2 \
\cf5 gatk \\\cf2 \
\cf5     GenomicsDBImport \\\cf2 \
\cf5     --genomicsdb-workspace-path ./genomicsdb/ \\\cf2 \
\cf5     --intervals $WHOLE_GENOME \\\cf2 \
\cf5     -V $GVCF1 -V $GVCF2 -V $GVCF3 ...\cf2 \
\
\cf5 gatk \\\cf2 \
\cf5     GenotypeGVCFs \\\cf2 \
\cf5     --reference $GENOME_FASTA \\\cf2 \
\cf5     --variant gendb://./genomicsdb  \\\cf2 \
\cf5     --output ./from_rnaseq.vcf.gz \\\cf2 \
\cf5     --standard-min-confidence-threshold-for-calling 13\cf2 \
\cf5 ```\cf2 \
\
\

\fs30 RNA-seq: Admixture
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\cf5 ```sh\cf2 \
\cf5 plink --bfile $BED_FILE --indep-pairwise 50 10 0.1 --allow-extra-chr --chr-set 38\cf2 \
\
\cf5 plink --bfile $BED_FILE --extract plink.prune.in --make-bed --out prunedData --allow-extra-chr --chr-set 38\cf2 \
\
\cf5 ```\cf2 \
\
Then\
\
\cf5 ```sh\cf2 \
\cf5 for K in 1 2 3 4 5 6 7 8; do admixture --cv $bed $K -j8 | tee log$\{K\}.out; done\cf2 \
\cf5 ```\cf2 \
\
\

\fs30 RNA-seq: Fst
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\cf5 ```sh\cf2 \
\cf5 vcftools --gzvcf $\{VCF\} --weir-fst-pop pop1 --weir-fst-pop pop2 --out pop1_pop2_weir.fst\cf2 \
\cf5 ```\cf2 \
\

\fs30 RNA-seq: PBE
\fs24 \

\fs30 \cf4 ----------
\fs24 \cf2 \
\cf5 ```R\cf2 \
\cf5 #Cavalli-Sforza transformation\cf2 \
\cf5 PBS_dataframe$T_CB <- -log(1-PBS_dataframe$C_B_Fst)\cf2 \
\cf5 PBS_dataframe$T_CY <- -log(1-PBS_dataframe$C_Y_Fst)\cf2 \
\cf5 PBS_dataframe$T_BY <- -log(1-PBS_dataframe$B_Y_Fst)\cf2 \
\
\cf5 #Remove Inf value \cf2 \
\cf5 PBS_dataframe <- subset(PBS_dataframe, !(PBS_dataframe$T_CB == "Inf"))\cf2 \
\cf5 PBS_dataframe <- subset(PBS_dataframe, !(PBS_dataframe$T_CY== "Inf"))\cf2 \
\cf5 PBS_dataframe <- subset(PBS_dataframe, !(PBS_dataframe$T_BY == "Inf"))\cf2 \
\
\
\cf5 PBS_dataframe$C_PBS <- (PBS_dataframe$T_CB + PBS_dataframe$T_CY - PBS_dataframe$T_BY)/2\cf2 \
\
\cf5 PBS_dataframe$C_PBS_0 <- pmax(PBS_dataframe$Cher_PBS, 0)\cf2 \
\
\cf5 PBS$C_PBS_med <- median(PBS$C_PBS_0)\cf2 \
\
\cf5 PBE = PBS(C) - ((T(BY)*PBS(C_median))/T(BY(median)))\cf2 \
\
\cf5 ```\cf2 \
\
\

\fs30 RNA-seq: WGCNA
\fs24 \

\fs30 \cf4 ---------
\fs24 \cf2 \
\cf5 ```R\cf2 \
\cf5 library(WGCNA)\cf2 \
\
\cf5 mergingThresh = 0.25\cf2 \
\cf5 net = blockwiseModules(Expr_data,corType="pearson",\cf2 \
\cf5                        maxBlockSize=nrow(log_wolfcounts_cpm),networkType="signed",power=15,minModuleSize=40,\cf2 \
\cf5                        mergeCutHeight=mergingThresh,numericLabels=TRUE,saveTOMs=TRUE,\cf2 \
\cf5                        pamRespectsDendro=FALSE,saveTOMFileBase="wolf_TOM")\cf2 \
\cf5 moduleLabelsAutomatic=net$colors\cf2 \
\cf5 ```\cf2 \
\
\
\
}